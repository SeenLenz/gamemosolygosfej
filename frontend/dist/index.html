<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="Content-Security-Policy" content="default-src 'self' http://localhost:9000; script-src 'self' 'unsafe-inline';">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <canvas id="main_canvas">
        </canvas>
    </body>
    <!-- <script src="../src/networking.js" type="module"></script> -->
    <script src="index.js" type="module"></script>
    <script type="x-shader/x-vertex" id="vertex_shader">#version 300 es
        in vec2 a_pos;
        in vec3 a_color;
        uniform vec2 u_res;

        uniform vec2 u_screen_position;
        uniform vec2 u_scale;

        uniform vec3 camera;

        out vec3 color;
        void main() {
            vec2 cameraClip = (camera.xy / u_res) * vec2(2, -2) * vec2(camera.z, camera.z);

            //calculate the transformations
            vec2 screenPos = a_pos * u_scale + u_screen_position;

            // convert to clip space
            screenPos = (screenPos / u_res) * vec2(2, 2) - vec2(1, 1);
            
            // flip y axis to match with js
            screenPos *= vec2(1, -1);

            gl_Position = vec4(screenPos * vec2(camera.z, camera.z) - cameraClip.xy, 0, 1);
            color = a_color;
        }
    </script>
    <script type="x-shader/x-fragment" id="fragment_shader">#version 300 es
        precision mediump float;

        in vec3 color;
        out vec4 fragColor;

        void main() {
            fragColor = vec4(color, 1);
        }
    </script>
</html>
